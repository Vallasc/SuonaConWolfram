(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35413,        822]
NotebookOptionsPosition[     34430,        799]
NotebookOutlinePosition[     34954,        817]
CellTagsIndexPosition[     34911,        814]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8290201672709923`*^9, 3.82902017375327*^9}, {
  3.829021066237901*^9, 3.829021070131528*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c72aff80-f4fe-4efc-a55b-fbc5c74effcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Load", " ", "MIDI", " ", "synth"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "LoadJavaClass", "[", "\"\<javax.sound.midi.MidiSystem\>\"", "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"synth", "=", 
     RowBox[{"MidiSystem`getSynthesizer", "[", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"synth", "@", 
     RowBox[{"open", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Channel", "=", 
     RowBox[{"First", "[", 
      RowBox[{"synth", "@", 
       RowBox[{"getChannels", "[", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8290176567169952`*^9, 3.8290176819054947`*^9}, {
  3.8290177886257534`*^9, 3.8290177889172516`*^9}, {3.829017825472681*^9, 
  3.8290178318116426`*^9}, {3.8290179085961337`*^9, 3.8290179087340956`*^9}, {
  3.8290179477755456`*^9, 3.8290179485602007`*^9}, {3.829020671605415*^9, 
  3.8290206722211995`*^9}, {3.829189543917426*^9, 3.8291895515617156`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a90f37b3-f7f7-4cc6-a790-37dea597ad9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Channel", "@", 
   RowBox[{"programChange", "[", "25", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8290179526269865`*^9, {3.8290217675114665`*^9, 3.8290217703124857`*^9}, {
   3.8290218885543737`*^9, 3.829021890073333*^9}, {3.8290228597892847`*^9, 
   3.829022876454204*^9}, {3.8291894486766596`*^9, 
   3.8291894578920493`*^9}},ExpressionUUID->"52caf788-dc38-401b-a815-\
5373dc0a4702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"synth", "@", 
   RowBox[{"close", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829020283913557*^9, 3.829020294255699*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"84ff5693-cacf-4e44-b295-547e94c103c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"scale", " ", "=", "2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"notes", "=", " ", 
     RowBox[{"List", "[", 
      RowBox[{
      "\"\<C\>\"", ",", " ", "\"\<C#\>\"", ",", "\"\<D\>\"", ",", " ", 
       "\"\<D#\>\"", ",", "\"\<E\>\"", ",", "\"\<F\>\"", ",", "\"\<F#\>\"", 
       ",", "\"\<G\>\"", ",", "\"\<G#\>\"", ",", " ", "\"\<A\>\"", ",", " ", 
       "\"\<A#\>\"", ",", "\"\<B\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toPitch", "[", 
      RowBox[{"note_", ",", "oct_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"notes", ",", " ", "note"}], "]"}], "]"}], "]"}], "-", 
        "1"}], ")"}], "+", " ", 
      RowBox[{"(", 
       RowBox[{"oct", "*", "12"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"whitekey", "[", 
      RowBox[{"note_", ",", "oct_"}], "]"}], ":=", 
     RowBox[{"Mouseover", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "]"}], ",", "White", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"shownotes", ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"note", "<>", 
                  RowBox[{"ToString", "[", "oct", "]"}]}], ",", "10", ",", 
                 "\"\<Label\>\""}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"22", "*", "scale"}], ",", 
            RowBox[{"41", "*", "scale"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.05"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}], ",", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"lights", ",", 
                  RowBox[{"Lighter", "[", 
                   RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "note", ",", "\"\<C\>\"", ",", "Red", ",", "\"\<D\>\"", 
                    ",", "Orange", ",", "\"\<E\>\"", ",", "Yellow", ",", 
                    "\"\<F\>\"", ",", "Green", ",", "\"\<G\>\"", ",", "Cyan", 
                    ",", "\"\<A\>\"", ",", "Blue", ",", "\"\<B\>\"", ",", 
                    "Purple"}], "]"}], ",", 
                    RowBox[{"oct", "/", "10"}]}], "]"}], ",", "White"}], 
                 "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "0.15", ",", "0"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "0.15", ",", "0"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "0.15", ",", "0"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"shownotes", ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"note", "<>", 
                    RowBox[{"ToString", "[", "oct", "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "9", ",", "10"}], "]"}], ",", 
                    "\"\<Label\>\""}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "1.1", ",", "1"}], "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"22", "*", "scale"}], ",", 
               RowBox[{"41", "*", "scale"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.05"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dwn", "=", "True"}], ";", 
              RowBox[{"$Channel", "@", 
               RowBox[{"noteOn", "[", 
                RowBox[{
                 RowBox[{"toPitch", "[", 
                  RowBox[{"note", ",", "oct"}], "]"}], ",", "80"}], "]"}]}]}],
              ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dwn", "=", "False"}], ";", " ", 
              RowBox[{"$Channel", "@", 
               RowBox[{"allNotesOff", "[", "]"}]}]}], ")"}]}]}], "}"}]}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"space", "[", "wd_", "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"White", ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"wd", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"wd", "*", "scale"}], ",", "Automatic"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vert", ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.001"}], ",", "0.001"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "*", "scale"}], ",", 
          RowBox[{"60", "*", "scale"}]}], "}"}]}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{"blackkey", "[", 
      RowBox[{"note_", ",", "oct_"}], "]"}], ":=", 
     RowBox[{"Mouseover", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Black", "]"}], ",", "Black", ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "2.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "5"}], "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"shownotes", ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"note", "<>", "\"\< \>\"", "<>", 
                  RowBox[{"ToString", "[", "oct", "]"}]}], ",", "10", ",", 
                 "White", ",", "\"\<Label\>\""}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", "3.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"12", "*", "scale"}], ",", 
            RowBox[{"60", "*", "scale"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.5", ",", "5"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}], ",", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"lights", ",", 
                 RowBox[{"Darker", "[", 
                  RowBox[{
                   RowBox[{"Switch", "[", 
                    RowBox[{
                    "note", ",", "\"\<C#\>\"", ",", "Red", ",", "\"\<D#\>\"", 
                    ",", "Orange", ",", "\"\<F#\>\"", ",", "Green", ",", 
                    "\"\<G#\>\"", ",", "Blue", ",", "\"\<A#\>\"", ",", 
                    "Purple"}], "]"}], ",", "0.5"}], "]"}], ",", "Black"}], 
                "]"}], ",", 
               RowBox[{"Rectangle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "0.05", ",", "0"}], "]"}], ",", 
                   "2.5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "0.4", ",", "0.5"}], "]"}], ",", 
                   "5"}], "}"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"shownotes", ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"note", "<>", "\"\< \>\"", "<>", 
                    RowBox[{"ToString", "[", "oct", "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"dwn", ",", "9", ",", "10"}], "]"}], ",", "White",
                     ",", "\"\<Label\>\""}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.25", ",", "3.5"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "}"}], "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"12", "*", "scale"}], ",", 
               RowBox[{"60", "*", "scale"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2.5", ",", "5"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dwn", "=", "True"}], ";", 
              RowBox[{"$Channel", "@", 
               RowBox[{"noteOn", "[", 
                RowBox[{
                 RowBox[{"toPitch", "[", 
                  RowBox[{"note", ",", "oct"}], "]"}], ",", "80"}], "]"}]}]}],
              ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dwn", "=", "False"}], ";", " ", 
              RowBox[{"$Channel", "@", 
               RowBox[{"allNotesOff", "[", "]"}]}]}], ")"}]}]}], "}"}]}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"whiteset", "[", "oct_", "]"}], ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"whitekey", "[", 
              RowBox[{"#", ",", "oct"}], "]"}], ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<C\>\"", ",", "\"\<D\>\"", ",", "\"\<E\>\"", ",", "\"\<F\>\"",
              ",", "\"\<G\>\"", ",", "\"\<A\>\"", ",", "\"\<B\>\""}], "}"}]}],
           "]"}], "]"}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"blackset", "[", "oct_", "]"}], ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"vert", ",", 
          RowBox[{"space", "[", "15", "]"}], ",", 
          RowBox[{"blackkey", "[", 
           RowBox[{"\"\<C#\>\"", ",", "oct"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"space", "[", "10", "]"}], ",", 
          RowBox[{"blackkey", "[", 
           RowBox[{"\"\<D#\>\"", ",", "oct"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"space", "[", "14.01", "]"}], ",", "vert", ",", 
          RowBox[{"space", "[", "0.01", "]"}], ",", "vert", ",", 
          RowBox[{"space", "[", "14.5", "]"}], ",", 
          RowBox[{"blackkey", "[", 
           RowBox[{"\"\<F#\>\"", ",", "oct"}], "]"}], ",", 
          RowBox[{"space", "[", "11", "]"}], ",", 
          RowBox[{"blackkey", "[", 
           RowBox[{"\"\<G#\>\"", ",", "oct"}], "]"}], ",", 
          RowBox[{"space", "[", "10.5", "]"}], ",", 
          RowBox[{"blackkey", "[", 
           RowBox[{"\"\<A#\>\"", ",", "oct"}], "]"}], ",", 
          RowBox[{"space", "[", "14", "]"}], ",", "vert"}], "}"}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"-", "0.04"}]}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyboardsplit", "[", "octinit_", "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"blackset", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "octinit", ",", 
              RowBox[{"octinit", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"whiteset", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "octinit", ",", 
              RowBox[{"octinit", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], "}"}],
        ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Columns\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ",", 
          RowBox[{"\"\<Rows\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"-", "0.1"}], "}"}], "}"}]}]}], "}"}]}], ",", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Columns\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", "Left", "}"}], "}"}]}], ",", 
          RowBox[{"\"\<Rows\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", "Top", "}"}], "}"}]}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Deploy", "[", 
     RowBox[{"keyboardsplit", "[", "4", "]"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lights", ",", "False", ",", "\"\<light keys\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shownotes", ",", "False", ",", "\"\<show notes\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"begoct", ",", "endoct", ",", "lights", ",", "shownotes"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"dwn", "=", "False"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.829016051322668*^9, 3.829016052581586*^9}, {
   3.8290162676145372`*^9, 3.8290162701882873`*^9}, {3.829016326809514*^9, 
   3.8290163647174625`*^9}, {3.8290164148941507`*^9, 3.829016441567795*^9}, {
   3.8290164738877935`*^9, 3.8290164789109993`*^9}, {3.8290165111456437`*^9, 
   3.829016542461417*^9}, {3.829016587461629*^9, 3.829016635106956*^9}, {
   3.8290166726492453`*^9, 3.829016676366921*^9}, {3.8290167345980024`*^9, 
   3.8290167879846983`*^9}, {3.8290168976099806`*^9, 
   3.8290168998020973`*^9}, {3.8290169300108585`*^9, 3.829016989307766*^9}, {
   3.8290170244258223`*^9, 3.829017307403041*^9}, {3.8290173828939266`*^9, 
   3.829017446447523*^9}, {3.829017541896556*^9, 3.829017552370433*^9}, {
   3.829017760559626*^9, 3.8290177795355406`*^9}, {3.8290178833090963`*^9, 
   3.8290178858290987`*^9}, {3.829018160767705*^9, 3.8290181830226965`*^9}, {
   3.8290183282917814`*^9, 3.8290183803895597`*^9}, {3.82901841990794*^9, 
   3.8290184200929403`*^9}, {3.829018667140561*^9, 3.8290187139885497`*^9}, {
   3.8290187695731497`*^9, 3.8290191456282487`*^9}, {3.8290200923743134`*^9, 
   3.8290200980242996`*^9}, {3.829020221007481*^9, 3.829020221418003*^9}, {
   3.829021175086218*^9, 3.829021247155593*^9}, {3.8290213213425975`*^9, 
   3.8290213463006067`*^9}, {3.82902142263013*^9, 3.829021428167514*^9}, {
   3.8290215121404476`*^9, 3.829021520665578*^9}, {3.8290215575906706`*^9, 
   3.829021572503524*^9}, {3.8290216177843943`*^9, 3.829021619471434*^9}, {
   3.8290216656833763`*^9, 3.8290216658544173`*^9}, 3.8290217100082293`*^9, {
   3.8290220027872024`*^9, 3.8290220130762005`*^9}, {3.8290220487870865`*^9, 
   3.8290220666776237`*^9}, {3.8290221197942657`*^9, 
   3.8290221261261888`*^9}, {3.8290222622734647`*^9, 3.82902229352623*^9}, {
   3.8290224113237534`*^9, 3.8290224943112197`*^9}, {3.8290225483216133`*^9, 
   3.8290225683815174`*^9}, {3.829022602631977*^9, 3.829022622746606*^9}, {
   3.829022730207048*^9, 3.8290228416481*^9}, {3.8290245238222613`*^9, 
   3.829024616218278*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c8a0d00a-9f55-45c1-a4d9-cbd3989803fb"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lights$$ = True, $CellContext`shownotes$$ = 
    True, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lights$$], False, "light keys"}, {True, False}}, {{
       Hold[$CellContext`shownotes$$], False, "show notes"}, {True, False}}}, 
    Typeset`size$$ = {616., {97.35000000000001, 103.35000000000001`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lights$$ = False, $CellContext`shownotes$$ = 
        False}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`scale = 
        2; $CellContext`notes = {
         "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", 
          "B"}; $CellContext`toPitch[
          Pattern[$CellContext`note, 
           Blank[]], 
          Pattern[$CellContext`oct, 
           Blank[]]] := (First[
            First[
             Position[$CellContext`notes, $CellContext`note]]] - 
          1) + $CellContext`oct 12; $CellContext`whitekey[
          Pattern[$CellContext`note$, 
           Blank[]], 
          Pattern[$CellContext`oct$, 
           Blank[]]] := Mouseover[
          Graphics[{{
             EdgeForm[], White, 
             Rectangle[{0, 0}, {1, 2}]}, {
             Line[{{0, 2}, {0, 0}, {1, 0}, {1, 2}}]}, 
            If[$CellContext`shownotes$$, 
             Text[
              Style[
               StringJoin[$CellContext`note$, 
                ToString[$CellContext`oct$]], 10, "Label"], {0.5, 1}], {}]}, 
           ImageSize -> {22 $CellContext`scale, 41 $CellContext`scale}, 
           PlotRange -> {{-0.01, 1.01}, {-0.05, 2}}, ImageMargins -> 0], 
          EventHandler[
           Dynamic[
            Graphics[{{
               EdgeForm[], 
               If[$CellContext`lights$$, 
                Lighter[
                 
                 Switch[$CellContext`note$, "C", Red, "D", Orange, "E", 
                  Yellow, "F", Green, "G", Cyan, "A", Blue, "B", 
                  Purple], $CellContext`oct$/10], White], 
               Rectangle[{0, 
                 If[$CellContext`dwn, 0.15, 0]}, {1, 2}]}, 
              Line[{{0, 2}, {0, 
                 If[$CellContext`dwn, 0.15, 0]}, {1, 
                 If[$CellContext`dwn, 0.15, 0]}, {1, 2}}], 
              If[$CellContext`shownotes$$, 
               Text[
                Style[
                 StringJoin[$CellContext`note$, 
                  ToString[$CellContext`oct$]], 
                 If[$CellContext`dwn, 9, 10], "Label"], {0.5, 
                 If[$CellContext`dwn, 1.1, 1]}], {}]}, 
             ImageSize -> {22 $CellContext`scale, 41 $CellContext`scale}, 
             PlotRange -> {{-0.01, 1.01}, {-0.05, 2}}, ImageMargins -> 0]], {
           "MouseDown" :> ($CellContext`dwn = True; $CellContext`$Channel[
               $CellContext`noteOn[
                $CellContext`toPitch[$CellContext`note$, $CellContext`oct$], 
                80]]), "MouseUp" :> ($CellContext`dwn = 
              False; $CellContext`$Channel[
               $CellContext`allNotesOff[]])}]]; $CellContext`space[
          Pattern[$CellContext`wd, 
           Blank[]]] := Graphics[{White, 
           Rectangle[{0, 0}, {$CellContext`wd, 1}]}, 
          ImageSize -> {$CellContext`wd $CellContext`scale, Automatic}, 
          PlotRange -> {{0, 0}, {2.5, 5}}, ImageMargins -> 
          0]; $CellContext`vert := Graphics[
          Line[{{0, 0}, {0, 1}}], PlotRange -> {{-0.001, 0.001}, {0, 1}}, 
          ImageSize -> {2 $CellContext`scale, 60 $CellContext`scale}, 
          ImageMargins -> 0]; $CellContext`blackkey[
          Pattern[$CellContext`note$, 
           Blank[]], 
          Pattern[$CellContext`oct$, 
           Blank[]]] := Mouseover[
          Graphics[{{
             EdgeForm[Black], Black, 
             Rectangle[{0, 2.5}, {0.5, 5}]}, 
            If[$CellContext`shownotes$$, 
             Text[
              Style[
               StringJoin[$CellContext`note$, " ", 
                ToString[$CellContext`oct$]], 10, White, "Label"], {0.25, 
              3.5}, {0, 0}, {0, 1}], {}]}, 
           ImageSize -> {12 $CellContext`scale, 60 $CellContext`scale}, 
           PlotRange -> {{0, 0.5}, {2.5, 5}}, ImageMargins -> 0], 
          EventHandler[
           Dynamic[
            Graphics[{{
               EdgeForm[Black], 
               If[$CellContext`lights$$, 
                Darker[
                 
                 Switch[$CellContext`note$, "C#", Red, "D#", Orange, "F#", 
                  Green, "G#", Blue, "A#", Purple], 0.5], Black], 
               Rectangle[{
                 If[$CellContext`dwn, 0.05, 0], 2.5}, {
                 If[$CellContext`dwn, 0.4, 0.5], 5}], 
               If[$CellContext`shownotes$$, 
                Text[
                 Style[
                  StringJoin[$CellContext`note$, " ", 
                   ToString[$CellContext`oct$]], 
                  If[$CellContext`dwn, 9, 10], White, "Label"], {0.25, 3.5}, {
                 0, 0}, {0, 1}], {}]}}, 
             ImageSize -> {12 $CellContext`scale, 60 $CellContext`scale}, 
             PlotRange -> {{0, 0.5}, {2.5, 5}}, ImageMargins -> 0]], {
           "MouseDown" :> ($CellContext`dwn = True; $CellContext`$Channel[
               $CellContext`noteOn[
                $CellContext`toPitch[$CellContext`note$, $CellContext`oct$], 
                80]]), "MouseUp" :> ($CellContext`dwn = 
              False; $CellContext`$Channel[
               $CellContext`allNotesOff[]])}]]; $CellContext`whiteset[
          Pattern[$CellContext`oct, 
           Blank[]]] := Grid[{
           Flatten[
            
            Map[$CellContext`whitekey[#, $CellContext`oct]& , {
             "C", "D", "E", "F", "G", "A", "B"}]]}, Spacings -> 
          0]; $CellContext`blackset[
          Pattern[$CellContext`oct, 
           Blank[]]] := Grid[{{$CellContext`vert, 
            $CellContext`space[15], 
            $CellContext`blackkey["C#", $CellContext`oct], 
            $CellContext`space[10], 
            $CellContext`blackkey["D#", $CellContext`oct], 
            $CellContext`space[14.01], $CellContext`vert, 
            $CellContext`space[0.01], $CellContext`vert, 
            $CellContext`space[14.5], 
            $CellContext`blackkey["F#", $CellContext`oct], 
            $CellContext`space[11], 
            $CellContext`blackkey["G#", $CellContext`oct], 
            $CellContext`space[10.5], 
            $CellContext`blackkey["A#", $CellContext`oct], 
            $CellContext`space[14], $CellContext`vert}}, Spacings -> -0.04, 
          Alignment -> Left]; $CellContext`keyboardsplit[
          Pattern[$CellContext`octinit, 
           Blank[]]] := Grid[{
           Flatten[
            Table[
             $CellContext`blackset[$CellContext`i], {$CellContext`i, \
$CellContext`octinit, $CellContext`octinit + 1}]], 
           Flatten[
            Table[
             $CellContext`whiteset[$CellContext`i], {$CellContext`i, \
$CellContext`octinit, $CellContext`octinit + 1}]]}, 
          Spacings -> {"Columns" -> {{0}}, "Rows" -> {{-0.1}}}, 
          Alignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}]; Deploy[
         $CellContext`keyboardsplit[4]]), 
      "Specifications" :> {{{$CellContext`lights$$, False, "light keys"}, {
         True, False}}, {{$CellContext`shownotes$$, False, "show notes"}, {
         True, False}}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`begoct, $CellContext`endoct, \
$CellContext`lights$$, $CellContext`shownotes$$}}, "DefaultOptions" :> {}],
     ImageSizeCache->{662., {144., 150.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`dwn = False}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.829016054472184*^9, {3.8290161371050158`*^9, 3.829016142925401*^9}, 
   3.8290162754891124`*^9, {3.829016339588128*^9, 3.8290163902651854`*^9}, {
   3.8290164220691442`*^9, 3.829016443362265*^9}, {3.829016517230565*^9, 
   3.829016552455201*^9}, {3.829016593205556*^9, 3.8290166363171387`*^9}, 
   3.8290166774247103`*^9, {3.8290167482273717`*^9, 3.8290167898404183`*^9}, 
   3.8290169014539924`*^9, {3.8290169438110695`*^9, 3.829016989986023*^9}, {
   3.8290170260371094`*^9, 3.8290173086254916`*^9}, {3.8290173852529306`*^9, 
   3.829017449268113*^9}, 3.829017793857312*^9, 3.8290178384366455`*^9, 
   3.829017887717101*^9, 3.8290179218940973`*^9, {3.8290201010473843`*^9, 
   3.8290201229780083`*^9}, {3.829020201488567*^9, 3.8290202238638353`*^9}, 
   3.8290211464032183`*^9, {3.8290212081442633`*^9, 3.8290212487146125`*^9}, 
   3.8290213498006*^9, {3.829021559315667*^9, 3.8290215760309725`*^9}, 
   3.8290216679283714`*^9, 3.829021718111264*^9, {3.829021752671502*^9, 
   3.8290217532814627`*^9}, 3.8290220710056157`*^9, {3.829022266282308*^9, 
   3.8290222963502893`*^9}, {3.829022414332718*^9, 3.829022454385789*^9}, 
   3.8290224959452105`*^9, {3.829022558013509*^9, 3.8290225703235292`*^9}, {
   3.829022607457073*^9, 3.829022631662648*^9}, {3.8290227386292324`*^9, 
   3.8290228422171006`*^9}, {3.829022902880274*^9, 3.8290229034223022`*^9}, {
   3.8290250319091434`*^9, 3.8290250393902445`*^9}, {3.8291893372934875`*^9, 
   3.82918934391755*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"2aeae3eb-dcde-4064-a37a-77260bdf3c4d"]
}, Open  ]]
},
WindowSize->{1057.3333333333333`, 536.3333333333334},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1e928417-c104-45a2-be5e-3c4cf7f80533"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 264, 5, 28, "Input",ExpressionUUID->"c72aff80-f4fe-4efc-a55b-fbc5c74effcd"],
Cell[825, 27, 1237, 30, 125, "Input",ExpressionUUID->"a90f37b3-f7f7-4cc6-a790-37dea597ad9e"],
Cell[2065, 59, 428, 9, 28, "Input",ExpressionUUID->"52caf788-dc38-401b-a815-5373dc0a4702"],
Cell[2496, 70, 243, 5, 28, "Input",ExpressionUUID->"84ff5693-cacf-4e44-b295-547e94c103c4"],
Cell[CellGroupData[{
Cell[2764, 79, 21504, 513, 1064, "Input",ExpressionUUID->"c8a0d00a-9f55-45c1-a4d9-cbd3989803fb"],
Cell[24271, 594, 10143, 202, 313, "Output",ExpressionUUID->"2aeae3eb-dcde-4064-a37a-77260bdf3c4d"]
}, Open  ]]
}
]
*)

